---
- hosts: all
  become: yes

  roles:
    - { role: base,   tags: ['base'  ] }
    - { role: docker, tags: ['docker'] }

- hosts: ghost
  become: yes

  vars:
    # Set environment to staging when testing certs to avoid
    # hitting the Lets Encrypt rate limits.
    # Set environment to production for use.
    docker_gen_container_name: docker-gen-nginx-proxy
    lets_encrypt_environment: staging

  roles:
    - { role: nginx_docker_gen, tags: ['nxinx_docker_gen'] }
    - { role: ghost,            tags: ['ghost'           ] }
    - { role: lets_encrypt,     tags: ['lets_encrypt'    ] }
